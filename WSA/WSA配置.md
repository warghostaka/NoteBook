# WSA配置

---

为了背单词，想在电脑上下载不背单词软件，之前使用的第三方安卓模拟器包括：雷电模拟器，蓝叠模拟器使用不背单词都非常卡顿

其中蓝叠模拟器无法实现平板的功能，同时不背单词最新版打不开，而雷电模拟器则是需要关闭虚拟化以提高性能，否则使用起来非常的卡顿，但为了确保虚拟机能够正常使用所以选择寻找别的方法，思考之下在电脑上配置了windows原生的安卓子系统WSA，但似乎仍然存在可能的问题，这个后面会讲

## 参考文章：

*[【教程】在电脑上优雅地使用不背单词、扇贝等APP，安装方法很简单！](https://www.bilibili.com/opus/984671452194144263?from=search&spm_id_from=333.337.0.0)*

*[Windows11 安装 google play 并设置代理](https://www.bilibili.com/opus/616646029700732351)*

*[WSA工具箱下载](https://apps.microsoft.com/detail/9ppsp2mkvtgt?hl=zh-CN&gl=CN)*

---

## 基本安装

### 1.Windows功能

**控制面板——程序和功能——启用或关闭Windows功能——虚拟机平台**

### 2.下载WSA

[使用 Github 上的大佬做的整合包，一键安装](https://github.com/MustardChef/WSABuilds/releases) 

对应标题：**Windows WSABuilds LTS Build #4 (15/07/24 - 2407.40000.0.0) for Windows 11 x64**

Assets：**WSA_2407.40000.0.0_x64_Release-Nightly-with-magisk-27.0.27000.-stable-GApps-13.0.7z**

下载完后解压到D盘

找到Install.ps1文件，使用powshell打开

整合包里包含了magisk和谷歌商店以及相关组件，**但是现在无法打开谷歌商店**

### 3.通过WSA工具箱安装APP

访问链接参考文献

WSA工具箱提供了ADB无法连接WSA的解决办法，同时能够使用Windows系统中的文件来安装.apk文件

操作完成后最终可以使用adb连上WSA，

WSA工具箱中似乎不包含adb，我的adb.exe位置：C:\platform-tools\adb.exe

### 4.不背单词安装

经过测试，不背单词的最新版本在WSA上是无法使用的（加载不出来），但是5.9.4版本能够正常运行，下载方式是从**豌豆荚**中下载apk文件，通过WSA工具箱安装

**附录：不背单词app快捷键**

​	背单词、复习：

​	Q / W / E：认识 / 模糊 / 不认识

​	N / M：下一词 / 记错了（不认识）

​	D：打开词典

​	P：发音

​	F：拼写

​	1，2，3，4：选词义对应四个选项

​	Enter：继续复习 / 开始拼写 / 复习完成 / 休息一下（有时要点两次）

​	默写：

​	← / →：上一词 / 下一词

​	Enter：提交拼写 / 下一词 

到这里安装完成，不背单词可以正常使用，网络也没有相关问题，唯一问题可能由于adb的相关原因，工具箱中经常出现连接不上WSA的问题，可以选择手动启动adb

命令 `adb connect 127.0.0.1:58526` 是用于通过 **ADB（Android Debug Bridge）** 连接到 **Windows Subsystem for Android (WSA)** 的步骤之一。以下是对该命令的详细解释以及如何在 PowerShell 中使用它。

```shell
adb connect 127.0.0.1:58526
```

* **adb**：Android Debug Bridge，是一个用于与 Android 设备通信的命令行工具。
* **connect**：ADB 的子命令，用于连接到指定的设备。
* **127.0.0.1**：这是本地回环地址（localhost），表示当前计算机。
* **58526**：这是 WSA 默认监听的端口号，ADB 通过这个端口与 WSA 通信，这个地址每次电脑重启都会变动，所以每次都会需要设置一次

---

## 配置代理

### 配置方法

安装完成后，发现仍然无法使用google player，虽然基本不会下载什么东西，但想尝试能否下载Chatgtp，以及Tiktok

找到文章后发现可以通过配置全局代理来解决

开启全局代理，在shell中输入 

```shell
settings put global http_proxy 172.30.0.1:7890
```

**clash默认端口7890**

### 关于全局代理以及命令

**全局代理**是指在设备或系统中，所有网络流量都通过指定的代理服务器进行转发。这意味着无论是浏览器、应用程序还是系统更新，所有的网络请求都会经过这个代理服务器。全局代理常用于以下场景：

1. **隐私保护**：通过代理服务器隐藏真实IP地址。
2. **访问限制内容**：绕过地理限制或防火墙，访问被屏蔽的网站或服务。
3. **网络监控**：在企业或学校环境中，监控和管理网络流量。

ADB（Android Debug Bridge）是一个用于与Android设备通信的命令行工具。通过ADB，你可以在设备上执行各种操作，包括修改系统设置。

```shell
adb shell settings put global http_proxy 172.30.0.1:10800
```

* **adb shell**：进入设备的命令行界面。
* **settings put global http_proxy 172.30.0.1:10800**：这是一个修改系统设置的命令，具体解释如下：
	* **settings**：Android系统中的一个工具，用于管理系统的各种设置。
	* **put**：表示要修改或添加一个设置项。
	* **global**：表示这是一个全局设置，影响整个系统。
	* **http_proxy**：这是要修改的设置项，表示HTTP代理。
	* **172.30.0.1:10800**：这是代理服务器的地址和端口号。在这个例子中，代理服务器的IP地址是`172.30.0.1`，端口号是`10800`



### WSA网络行为

#### 1. **WSA 的默认网络行为**

WSA 默认会继承 Windows 主机的网络配置，包括代理设置。如果你的 Windows 主机配置了代理（例如 `127.0.0.1:7890`），WSA 也会自动使用这个代理访问网络。

* **如果代理服务器软件未运行**：
	* 当代理服务器软件（例如 Clash、V2Ray 等）未运行时，`127.0.0.1:7890` 这个端口是无法连接的。
	* 由于 WSA 依赖于 Windows 主机的网络配置，如果代理服务器不可用，WSA 的网络访问会失败。
	* 这意味着 **WSA 会失去网络连接**，因为它无法通过代理服务器访问外部网络。

------

#### 2. **如何取消 WSA 的自定义代理**

如果你不希望 WSA 使用自定义代理（例如 `127.0.0.1:7890`），而是直接使用 Windows 主机的网络连接，可以通过以下方法取消代理配置：

##### 方法 1：使用 ADB 命令清除代理

运行以下命令清除 WSA 的全局代理设置：

```shell
adb shell settings put global http_proxy :0
```

* 这个命令会将 WSA 的代理设置为空，使其不再使用自定义代理。
* 之后，WSA 会直接使用 Windows 主机的网络连接，而不经过代理服务器。

##### 方法 2：在 Windows 主机中禁用代理

如果你在 Windows 主机中配置了系统代理（例如 `127.0.0.1:7890`），可以通过以下步骤禁用代理：

1. 打开 **设置** > **网络和 Internet** > **代理**。
2. 在 **手动设置代理** 部分，关闭 **使用代理服务器** 选项。
3. 保存设置后，WSA 会继承 Windows 主机的网络配置，不再使用代理。

------

#### 3. **WSA 的网络依赖关系**

WSA 的网络访问完全依赖于 Windows 主机的网络配置：

* **如果 Windows 主机有网**：WSA 可以直接访问网络（无论是否配置代理）。
* **如果 Windows 主机没有网**：WSA 也无法访问网络。
* **如果 Windows 主机配置了代理但代理服务器未运行**：WSA 会尝试通过代理访问网络，但由于代理服务器不可用，WSA 会失去网络连接。

---

### 4. **总结**

* WSA 默认会继承 Windows 主机的网络配置，包括代理设置。
* 如果你配置了自定义代理（例如 `127.0.0.1:7890`），但代理服务器软件未运行，WSA 会失去网络连接。
* 如果你不希望 WSA 使用代理，可以通过 ADB 命令清除代理设置，或者直接在 Windows 主机中禁用代理。
* WSA 的网络访问完全依赖于 Windows 主机的网络状态，确保 Windows 主机网络正常是 WSA 正常访问网络的前提。

---

## 存在问题

### 谷歌商店问题

配置完代理之后反而是完全没有网络了，不知道是什么情况，不过在不配置网络的情况下能够使用不背单词（雷电要是能正常使用5.9.4版那就白搞了😭）

但即便是默认情况下，wsa似乎还是无法使用Windows系统中的代理，表现为谷歌搜索无法使用，但可能的原因还有谷歌框架的问题，也许未来可以通过使用当时我配置手机谷歌商店的方法来解决

### WSA以后不支持了

到2025-3-5以后就不支持了，不过似乎有解决办法，明天再找找